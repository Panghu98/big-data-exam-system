<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.swpu.jdata_exam.dao.UserScoreDAO">

    <!--UserScore getScoreById(String userId);-->
    <select id="getScoreById" resultType="cn.edu.swpu.jdata_exam.entity.UserScore">
        SELECT
        id,
        user_id userId,
        accuracy accuracy,
        date_time dateTime
        FROM
        jdata_user_score
        WHERE
        user_id=#{userId}
        ORDER BY
        user_score DESC
    </select>

    <!--int addScore(UserScore userScore);-->
    <insert id="addScore" parameterType="cn.edu.swpu.jdata_exam.entity.UserScore">
        INSERT INTO
            jdata_user_score
            (user_id,date_time,accuracy,frequency)
        VALUES
            (#{userId},#{dateTime},#{accuracy},#{frequency})

    </insert>

    <select id="selectByTime" parameterType="date" resultType="cn.edu.swpu.jdata_exam.entity.UserScore">
        select distinct `user_id` as userId,accuracy as accuracy,frequency frequency,date_time as dateTime
        from jdata_user_score order by userId desc ;
    </select>
    <select id="getRankingList" resultType="cn.edu.swpu.jdata_exam.entity.UserScore2">
        select a.user_id as userId,max(accuracy) as accuracy,b.username as username from jdata_user_score a
        inner join jdata_user_basic_info b on a.user_id = b.user_id  where a.user_id in
        <foreach collection="list" separator="," open="(" close=")" index="" item="type">
            #{type, jdbcType=VARCHAR}
        </foreach>

        group by userId order by accuracy desc
    </select>
    <select id="getUserList" resultType="java.lang.Long">
        select distinct user_id from jdata_user_score ;
    </select>


</mapper>